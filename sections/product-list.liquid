
{%- liquid
    assign filtered_products = "" | split: ""
    assign short_names_taken = "" | split: ""
    assign current_short_name = product.metafields.custom.short_name.value | sort
    assign short_names_taken = short_names_taken | concat: current_short_name
    assign prods_all = product.metafields.custom.collection.value.products | sort: 'metafields.custom.short_name.value'

    for prod in prods_all
        assign taken = false
        for sn in short_names_taken
            if sn == prod.metafields.custom.short_name.value
                assign taken = true
            endif
        endfor
        if taken == false
            assign prod_arr = prod | sort
            assign filtered_products = filtered_products | concat: prod_arr
            assign current_short_name = prod.metafields.custom.short_name.value | sort
            assign short_names_taken = short_names_taken | concat: current_short_name
        endif
    endfor
-%}

<div
    class="product-list"
    style = "padding-top:{{ section.settings.padding_top }}px;padding-bottom:{{ section.settings.padding_bottom }}px"
  >
    <h2 class = "font-display text-5xl text-pri-head uppercase font-black mb-12">
        {{ section.settings.heading }}
    </h2>


    {% render 'scrolling-products',
        section_id: section.id,
        products: filtered_products
    %}
  </div>    
  
  {% schema %}
  {
    "name": "Product List",
    "tag": "section",
    "class": "section",
    "settings": [ 
        {
            "type": "header",
            "content": "Product List Information"
        },
        {
            "type": "text",
            "id": "heading",
            "label": "t:sections.related-products.settings.heading.label"
        },
        {
            "type": "header",
            "content": "t:sections.all.padding.section_padding_heading"
        },
        {
            "type": "range",
            "id": "padding_top",
            "min": 0,
            "max": 100,
            "step": 4,
            "unit": "px",
            "label": "t:sections.all.padding.padding_top",
            "default": 36
        },
        {
            "type": "range",
            "id": "padding_bottom",
            "min": 0,
            "max": 100,
            "step": 4,
            "unit": "px",
            "label": "t:sections.all.padding.padding_bottom",
            "default": 36
        }
    ],
    "presets": [
        {
            "name": "List of Products",
            "category": "custom"
        }
    ],
    "enabled_on": {
        "templates": ["product"]
    }
  }
  {% endschema %}
  